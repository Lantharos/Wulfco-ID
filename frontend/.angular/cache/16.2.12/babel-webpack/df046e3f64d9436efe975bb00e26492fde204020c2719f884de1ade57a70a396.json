{"ast":null,"code":"import _asyncToGenerator from \"D:/Wulfco/Wulfco ID 2/frontend-angular/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";\nimport { Component } from '@angular/core';\nimport { AuthCrypto } from \"../../util/AuthCrypto\";\nimport { config } from \"../../config\";\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/platform-browser\";\nimport * as i2 from \"@angular/common\";\nimport * as i3 from \"../../components/pages/registration/registration-name/registration-name.component\";\nimport * as i4 from \"../../components/pages/registration/registration-security/registration-security.component\";\nimport * as i5 from \"../../components/pages/registration/registration-profile/registration-profile.component\";\nimport * as i6 from \"../../components/pages/registration/registration-start/registration-start.component\";\nfunction CreateId_registration_start_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r5 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"registration-start\", 2);\n    i0.ɵɵlistener(\"submit\", function CreateId_registration_start_1_Template_registration_start_submit_0_listener($event) {\n      i0.ɵɵrestoreView(_r5);\n      const ctx_r4 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r4.submit($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateId_registration_name_2_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r7 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"registration-name\", 2);\n    i0.ɵɵlistener(\"submit\", function CreateId_registration_name_2_Template_registration_name_submit_0_listener($event) {\n      i0.ɵɵrestoreView(_r7);\n      const ctx_r6 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r6.submit($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateId_registration_security_3_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r9 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"registration-security\", 2);\n    i0.ɵɵlistener(\"submit\", function CreateId_registration_security_3_Template_registration_security_submit_0_listener($event) {\n      i0.ɵɵrestoreView(_r9);\n      const ctx_r8 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r8.submit($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nfunction CreateId_registration_profile_4_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r11 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"registration-profile\", 2);\n    i0.ɵɵlistener(\"submit\", function CreateId_registration_profile_4_Template_registration_profile_submit_0_listener($event) {\n      i0.ɵɵrestoreView(_r11);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r10.submit($event));\n    });\n    i0.ɵɵelementEnd();\n  }\n}\nconst AH = new AuthCrypto();\nexport let CreateId = /*#__PURE__*/(() => {\n  class CreateId {\n    title;\n    meta;\n    stage = 1;\n    encryptionKey;\n    iv;\n    constructor(title, meta) {\n      this.title = title;\n      this.meta = meta;\n      AH.GenerateAESKey().then(key => {\n        this.encryptionKey = key;\n        this.iv = new Uint8Array(16);\n      });\n      this.title.setTitle('Create an ID');\n      this.meta.addTags([{\n        name: 'description',\n        content: \"Don't have an ID? No worries! Just create one, today, for free.\"\n      }, {\n        property: 'og:title',\n        content: 'Create an Account'\n      }, {\n        property: 'og:description',\n        content: 'Wulfco ID is a place where you can create one ID that you will use for all of the services created by Wulfco LLC.'\n      }, {\n        property: 'og:image',\n        content: 'https://aheioqhobo.cloudimg.io/v7/_playground-bucket-v2.teleporthq.io_/39ebfb3d-48ba-4ad3-b4e3-71d35b211205/70dc84ed-902e-47ba-a9d3-d75e24c32e1d?org_if_sml=1'\n      }]);\n    }\n    prepareData(data) {\n      var _this = this;\n      return _asyncToGenerator(function* () {\n        const oldEncryptedData = sessionStorage.getItem('wulfco_id');\n        const oldData = JSON.parse(yield AH.AESDecrypt(new Uint8Array(oldEncryptedData.split(\",\").map(Number)), _this.encryptionKey, _this.iv));\n        const jsonData = yield AH.AESEncrypt(JSON.stringify({\n          ...oldData,\n          ...data\n        }), _this.encryptionKey, _this.iv);\n        sessionStorage.setItem('wulfco_id', jsonData);\n      })();\n    }\n    submit(data) {\n      var _this2 = this;\n      return _asyncToGenerator(function* () {\n        if (data.stage === 1) {\n          const jsonData = JSON.stringify({\n            email: data.email,\n            password: data.password\n          });\n          const oldData = sessionStorage.getItem('wulfco_id');\n          if (oldData) {\n            sessionStorage.removeItem('wulfco_id');\n          }\n          const encryptedData = yield AH.AESEncrypt(jsonData, _this2.encryptionKey, _this2.iv);\n          sessionStorage.setItem('wulfco_id', encryptedData);\n          _this2.stage = 2;\n        } else if (data.stage === 2) {\n          yield _this2.prepareData(data);\n          sessionStorage.setItem('firstName', data.name.split(\" \")[0]);\n          _this2.stage = 3;\n        } else if (data.stage === 3) {\n          yield _this2.prepareData(data);\n          _this2.stage = 4;\n        } else if (data.stage === 4) {\n          const oldEncryptedData = sessionStorage.getItem('wulfco_id');\n          const oldData = JSON.parse(yield AH.AESDecrypt(new Uint8Array(oldEncryptedData.split(\",\").map(Number)), _this2.encryptionKey, _this2.iv));\n          const newData = {\n            ...oldData,\n            ...data\n          };\n          newData['password'] = yield AH.Hash(newData['password'] + newData['username']);\n          const encryptedData = yield new AuthCrypto().SimpleEncrypt(JSON.stringify(newData));\n          fetch(config.api_url + \"/register\", {\n            method: 'POST',\n            headers: {\n              'Content-Type': 'application/json'\n            },\n            body: JSON.stringify(encryptedData)\n          }).then(response => response.json()).then(resData => {\n            if (resData.error) {\n              console.error(resData.error);\n            } else {\n              console.log(resData);\n              document.getElementById('finish').removeAttribute('disabled');\n              document.getElementById('registration-profile-text4').innerHTML = 'Finish Registration';\n              document.getElementById('registration-profile-icon').style.display = 'inline-block';\n              // sessionStorage.removeItem('wulfco_id')\n              // sessionStorage.removeItem('firstName')\n            }\n          });\n        }\n      })();\n    }\n\n    static ɵfac = function CreateId_Factory(t) {\n      return new (t || CreateId)(i0.ɵɵdirectiveInject(i1.Title), i0.ɵɵdirectiveInject(i1.Meta));\n    };\n    static ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: CreateId,\n      selectors: [[\"create-id\"]],\n      decls: 5,\n      vars: 5,\n      consts: [[1, \"create-id-container\", 3, \"ngSwitch\"], [3, \"submit\", 4, \"ngSwitchCase\"], [3, \"submit\"]],\n      template: function CreateId_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0);\n          i0.ɵɵtemplate(1, CreateId_registration_start_1_Template, 1, 0, \"registration-start\", 1)(2, CreateId_registration_name_2_Template, 1, 0, \"registration-name\", 1)(3, CreateId_registration_security_3_Template, 1, 0, \"registration-security\", 1)(4, CreateId_registration_profile_4_Template, 1, 0, \"registration-profile\", 1);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵproperty(\"ngSwitch\", ctx.stage);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngSwitchCase\", 1);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngSwitchCase\", 2);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngSwitchCase\", 3);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngSwitchCase\", 4);\n        }\n      },\n      dependencies: [i2.NgSwitch, i2.NgSwitchCase, i3.RegistrationName, i4.RegistrationSecurity, i5.RegistrationProfile, i6.RegistrationStart],\n      styles: [\"[_nghost-%COMP%]{display:contents}.create-id-container[_ngcontent-%COMP%]{width:100%;display:flex;overflow:auto;min-height:100vh;align-items:center;flex-direction:column;background-color:#121212;justify-items:center;justify-content:center}\"]\n    });\n  }\n  return CreateId;\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassMetadata(CreateId, [{\n    type: Component,\n    args: [{\n      selector: 'create-id',\n      template: \"<div class=\\\"create-id-container\\\" [ngSwitch]=\\\"stage\\\">\\n    <registration-start *ngSwitchCase=\\\"1\\\" (submit)=\\\"submit($event)\\\"></registration-start>\\n    <registration-name *ngSwitchCase=\\\"2\\\" (submit)=\\\"submit($event)\\\"></registration-name>\\n    <registration-security *ngSwitchCase=\\\"3\\\" (submit)=\\\"submit($event)\\\"></registration-security>\\n    <registration-profile *ngSwitchCase=\\\"4\\\" (submit)=\\\"submit($event)\\\"></registration-profile>\\n</div>\\n\",\n      styles: [\":host{display:contents}.create-id-container{width:100%;display:flex;overflow:auto;min-height:100vh;align-items:center;flex-direction:column;background-color:#121212;justify-items:center;justify-content:center}\\n\"]\n    }]\n  }], () => [{\n    type: i1.Title\n  }, {\n    type: i1.Meta\n  }], null);\n})();\n(() => {\n  (typeof ngDevMode === \"undefined\" || ngDevMode) && i0.ɵsetClassDebugInfo(CreateId, {\n    className: \"CreateId\",\n    filePath: \"src\\\\app\\\\pages\\\\create-id\\\\create-id.component.ts\",\n    lineNumber: 14\n  });\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}